import{a as I,b as f}from"./chunk-M3HRAS6G.js";import{D as M,F as x,G as P,H as j,I as k,J as A,L as E,b,c as _,g as v,h as p,i as h,j as r,k as d,l as S,m as g,n as u,o as C,p as c,q as a,r as w,s as D,t as l,u as m,v as T,x as y}from"./chunk-CIYRZLFO.js";function L(n,o){if(n&1){let s=D();c(0,"div",4)(1,"panel",5)(2,"div",6)(3,"div",7)(4,"custom-button",8),l("click",function(){p(s);let t=m();return h(t.cancelModal())}),a()(),c(5,"div",7)(6,"custom-button",9),l("click",function(){p(s);let t=m();return h(t.acceptModal())}),a()()()()()}if(n&2){let s=m();r(),T("title","Estas seguro de eliminar el producto ",s.productToDelete==null?null:s.productToDelete.name,"?"),r(3),u("primary",!1)}}var Y=(()=>{let o=class o{constructor(e,t,i){this.router=e,this.productService=t,this.notificationService=i,this.products=[],this.productsToShow=[],this.columnDefinition=[],this.tableActions=[],this.searchModel=S(void 0),this.searchDebounceSubject=new b,this.showDeleteModal=!1}ngOnInit(){this.columnDefinition=[{attr:"logo",label:"Logo"},{attr:"name",label:"Nombre del producto"},{attr:"description",label:"Descripci\xF3n"},{attr:"date_release",label:"Fecha de liberaci\xF3n"},{attr:"date_revision",label:"Fecha de reestructuracion"}],this.tableActions=[{id:"update",label:"Editar",fn:e=>{this.productService.setProduct(e),this.router.navigateByUrl("/product-edit")}},{id:"delete",label:"Borrar",fn:e=>{this.productToDelete=e,this.showDeleteModal=!0}}],this.fetch(),this.searchDebounceSubject.pipe(_(500)).subscribe(e=>this.filterByName(e))}fetch(){this.productService.getAll(f).subscribe(e=>{this.products=e,this.productsToShow=this.products})}onSearchChange(e){this.searchDebounceSubject.next(e)}filterByName(e){this.productsToShow=this.products.filter(t=>t.name.includes(e))}navigateToAddPage(){this.productService.setProduct(void 0),this.router.navigateByUrl("/product-edit")}acceptModal(){this.productToDelete&&this.productService.delete(f,this.productToDelete).subscribe({next:()=>{this.showDeleteModal=!1,this.notificationService.addSuccess("Producto eliminado exitosamente!"),this.fetch()},error:e=>{if(this.showDeleteModal=!1,e.status===200){this.notificationService.addSuccess("Producto eliminado exitosamente!"),this.fetch();return}this.notificationService.addError("Error al intentar eliminar el producto!")}})}cancelModal(){this.showDeleteModal=!1}};o.\u0275fac=function(t){return new(t||o)(d(M),d(I),d(A))},o.\u0275cmp=v({type:o,selectors:[["product-list"]],standalone:!0,features:[y],decls:6,vars:5,consts:[[1,"header"],["attr","search","placeholder","Search...",3,"onChange","model"],["id","create","label","Agregar",3,"click"],[3,"rowObjects","columnDefinitions","actions"],[1,"modal"],[3,"title"],[1,"row"],[1,"col","center"],["label","Cancelar",3,"click","primary"],["label","Aceptar",3,"click"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"text-field",1),l("onChange",function(F){return i.onSearchChange(F)}),a(),c(2,"custom-button",2),l("click",function(){return i.navigateToAddPage()}),a()(),c(3,"div"),w(4,"custom-table",3),a(),g(5,L,7,3,"div",4)),t&2&&(r(),u("model",i.searchModel),r(3),u("rowObjects",i.productsToShow)("columnDefinitions",i.columnDefinition)("actions",i.tableActions),r(),C(5,i.showDeleteModal?5:-1))},dependencies:[E,x,P,j,k],styles:[".header[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100%;width:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center}"]});let n=o;return n})();export{Y as ProductListComponent};
